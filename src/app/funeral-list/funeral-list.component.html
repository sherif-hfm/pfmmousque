<div class="funeral-list">
  <div class="cards-container">
    <section class="card card-main" aria-label="معلومات اليوم">
      <div class="card-main-inner">
        <p class="card-main-day">{{ umalquraCalendar.getCurrentDate().dayName }}</p>
        <p class="card-main-date card-main-hijri">
          {{ arabicNums.toArabicNum(umalquraCalendar.getCurrentDate().year + '/' + umalquraCalendar.getCurrentDate().month + '/' + umalquraCalendar.getCurrentDate().day) }} هـ
        </p>
        <p class="card-main-date card-main-gregorian">
          {{ arabicNums.toArabicNum(getCurrentDateV2()) }} م
        </p>
        <a class="card-main-location" href="https://maps.app.goo.gl/rR4tG5hT5QTyHLfu9" target="_blank" rel="noopener noreferrer" title="الموقع على خرائط جوجل">
          <i class="fa-solid fa-location-dot" aria-hidden="true"></i>
          الموقع على الخريطة
        </a>
        <p class="card-main-total">{{ arabicNums.toArabicNum(prayerTodayTotal) }}</p>
        <p class="card-main-label">جنازة</p>
      </div>
    </section>

    <article class="card card-prayer" *ngFor="let prayer of funeralList" [attr.aria-label]="'صلاة ' + prayer.prayerName">
      <div class="card-prayer-inner" *ngIf="prayer.Total > 0">
        <h2 class="card-prayer-title">صلاة <span>{{ prayer.prayerName }}</span></h2>
        <p class="card-prayer-count">
          عدد الجنائز <span class="card-prayer-num">{{ toArabicNum(prayer.Total) }}</span>
        </p>
        <div class="info-container">
          <div class="info" *ngIf="prayer.M > 0">
            <span class="info-label">رجال</span>
            <span class="info-number">{{ toArabicNum(prayer.M) }}</span>
          </div>
          <div class="info" *ngIf="prayer.F > 0">
            <span class="info-label">نساء</span>
            <span class="info-number">{{ toArabicNum(prayer.F) }}</span>
          </div>
          <div class="info" *ngIf="(prayer.B + prayer.G) > 0">
            <span class="info-label">اطفال</span>
            <span class="info-number">{{ toArabicNum(prayer.B + prayer.G) }}</span>
          </div>
        </div>
        <div class="card-prayer-actions">
          <button type="button" class="btn btn-details" (click)="openDetailsPopup(prayer.prayerId)">
            عرض التفاصيل
          </button>
        </div>
      </div>
    </article>
  </div>
</div>

<modal [(show)]="showdetails">
  <div class="dtlContainer" *ngIf="showdetails">
    <h2 class="dtlTitle">تفاصيل الجنائز</h2>
    <div class="dtlGrid" role="table" aria-label="قائمة الجنائز">
      <div class="dtlHeader" role="columnheader">اسم المتوفى</div>
      <div class="dtlHeader" role="columnheader">الجنس</div>
      <div class="dtlHeader" role="columnheader">مكان الدفن</div>
      <div class="dtlHeader" role="columnheader">رقم الإسعاف</div>
      <div class="dtlHeader" role="columnheader">رقم القبر</div>
      <div class="dtlHeader" role="columnheader">ملاحظات</div>
      <ng-container *ngFor="let funeral of funeralDetails">
        <div class="dtlCell" role="cell">
          <span class="dtlMobileLabel">اسم المتوفى:</span>
          {{ funeral.deadName }}
        </div>
        <div class="dtlCell" role="cell">
          <span class="dtlMobileLabel">الجنس:</span>
          {{ funeral.sex.Name }}
        </div>
        <div class="dtlCell" role="cell">
          <span class="dtlMobileLabel">مكان الدفن:</span>
          {{ funeral.purialplace.placeName }}
        </div>
        <div class="dtlCell" role="cell">
          <span class="dtlMobileLabel">رقم الإسعاف:</span>
          {{ funeral.ambulanceNo || '—' }}
        </div>
        <div class="dtlCell" role="cell">
          <span class="dtlMobileLabel">رقم القبر:</span>
          {{ funeral.graveNo || '—' }}
        </div>
        <div class="dtlCell" role="cell">
          <span class="dtlMobileLabel">ملاحظات:</span>
          {{ funeral.notes || '—' }}
        </div>
      </ng-container>
    </div>
    <div class="dtlDivider"></div>
    <p class="dtlFooter">رحمهم الله وأسكنهم فسيح جناته</p>
  </div>
</modal>
